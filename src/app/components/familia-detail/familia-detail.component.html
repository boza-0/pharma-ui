<ng-container *ngIf="familia$ | async as familia">
  <h1>{{ familia.nombre }}</h1>
</ng-container>

<div class="view-toggle">
  <button (click)="viewMode = 'compact'">compact</button>
  <button (click)="viewMode = 'tiles'">tiles</button>
</div>

<ng-container *ngIf="productos$ | async as productos">
  <ng-container *ngIf="productos.length > 0; else empty">

    <!-- COMPACT VIEW -->
    <table *ngIf="viewMode === 'compact'" class="productos-table">
      <thead>
        <tr>
          <th>categoria_nombre</th>
          <th>subcategoria_nombre</th>
          <th>familia_nombre</th>
          <th>marca</th>
          <th>nombre</th>
          <th>unidades_por_envase</th>
          <th>comentarios</th>
          <th>foto_url</th>
          <th>concentracion</th>
          <th>forma_farmaceutica</th>
          <th>principio_activo</th>
          <th>sustancia_controlada</th>
          <th>requiere_serializacion</th>
          <th>via_administracion_nombre</th>
          <th>stock</th>
          <th>pvp</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let p of productos">
          <td>{{ p.categoria_nombre }}</td>
          <td>{{ p.subcategoria_nombre }}</td>
          <td>{{ p.familia_nombre }}</td>
          <td>{{ p.marca }}</td>
          <td>{{ p.nombre }}</td>
          <td>{{ p.unidades_por_envase }}</td>
          <td>{{ p.comentarios }}</td>
          <td>{{ p.foto_url }}</td>
          <td>{{ p.concentracion }}</td>
          <td>{{ p.forma_farmaceutica }}</td>
          <td>{{ p.principio_activo }}</td>
          <td>{{ p.sustancia_controlada }}</td>
          <td>{{ p.requiere_serializacion }}</td>
          <td>{{ p.via_administracion_nombre }}</td>
          <td>{{ p.stock }}</td>
          <td>{{ p.pvp }}</td>
        </tr>
      </tbody>
    </table>

    <!-- TILE VIEW -->
    <div *ngIf="viewMode === 'tiles'">
      <div *ngFor="let p of productos">
        <div><strong>categoria_nombre</strong>: {{ p.categoria_nombre }}</div>
        <div><strong>subcategoria_nombre</strong>: {{ p.subcategoria_nombre }}</div>
        <div><strong>familia_nombre</strong>: {{ p.familia_nombre }}</div>

        <div><strong>marca</strong>: {{ p.marca }}</div>
        <div><strong>nombre</strong>: {{ p.nombre }}</div>

        <div><strong>unidades_por_envase</strong>: {{ p.unidades_por_envase }}</div>
        <div><strong>comentarios</strong>: {{ p.comentarios }}</div>
        <div><strong>foto_url</strong>: {{ p.foto_url }}</div>

        <div><strong>concentracion</strong>: {{ p.concentracion }}</div>
        <div><strong>forma_farmaceutica</strong>: {{ p.forma_farmaceutica }}</div>
        <div><strong>principio_activo</strong>: {{ p.principio_activo }}</div>

        <div><strong>sustancia_controlada</strong>: {{ p.sustancia_controlada }}</div>
        <div><strong>requiere_serializacion</strong>: {{ p.requiere_serializacion }}</div>

        <div><strong>via_administracion_nombre</strong>: {{ p.via_administracion_nombre }}</div>
        <div><strong>stock</strong>: {{ p.stock }}</div>
        <div><strong>pvp</strong>: {{ p.pvp }}</div>

        <hr />
      </div>
    </div>

  </ng-container>

  <ng-template #empty>
    <p>No hay productos en esta familia.</p>
  </ng-template>
</ng-container>
